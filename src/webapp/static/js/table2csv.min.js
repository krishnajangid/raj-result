!function(e){"use strict";const t={filename:"table.csv",appendTo:"body",separator:",",newline:"\n",quoteFields:!0,trimContent:!0,excludeColumns:"",excludeRows:""};let n={};function o(t){let o="";const r=t.find("tr").not(n.excludeRows),i=r.first().find("td,th").filter(":visible").not(n.excludeColumns).length;return r.each(function(t,r){e(r).find("td,th").filter(":visible").not(n.excludeColumns).each(function(t,r){const l=e(r),s=n.trimContent?e.trim(l.text()):l.text();o+=n.quoteFields?'"'+s.replace('"','""')+'"':s,o+=t!==i-1?n.separator:n.newline})}),o}e.fn.table2csv=function(r,i){if("object"==typeof r?(i=r,r="download"):void 0===r&&(r="download"),"string"!=typeof r)throw new Error('"action" argument must be a string');if(void 0!==i&&"object"!=typeof i)throw new Error('"options" argument must be an object');n=e.extend({},t,i);const l=this.filter("table");if(l.length<=0)throw new Error("table2csv must be called on a <table> element");if(l.length>1)throw new Error("converting multiple table elements at once is not supported yet");let s;switch(r){case"download":s=o(l),function(e,t){const n=document.createElement("a");n.setAttribute("href","data:text/csv;charset=utf-8,\ufeff"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}(n.filename,s);break;case"output":s=o(l),e(n.appendTo).append(e("<pre>").text(s));break;default:throw new Error('"action" argument must be one of the supported action strings')}return this}}(jQuery);